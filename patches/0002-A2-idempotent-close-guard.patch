diff --git a/ngx_http_upstream_ntlm_module.c b/ngx_http_upstream_ntlm_module.c
--- a/ngx_http_upstream_ntlm_module.c
+++ b/ngx_http_upstream_ntlm_module.c
@@
 static void
 ngx_http_upstream_ntlm_close_handler(ngx_event_t *ev)
 {
     ngx_connection_t *c = ev->data;
-    if (c->fd == (ngx_socket_t)-1 || c->close) {
+    /* idempotent guard */
+    if (c->fd == (ngx_socket_t)-1 || c->close) {
         return;
     }
@@
-    if (!c->read->timedout) {
+    if (!c->read->timedout) {
         int n; char b[1];
         n = recv(c->fd, b, 1, MSG_PEEK);
         if (n == -1 && ngx_socket_errno == NGX_EAGAIN) {
             ev->ready = 0;
             if (ngx_handle_read_event(c->read, 0) == NGX_OK) {
                 return;
             }
         }
     }