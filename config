ngx_addon_name=ngx_http_upstream_ntlm_module

if test -n "$ngx_module_link"; then
    # Сборка через auto/module (статический/динамический модуль)
    ngx_module_type=HTTP
    ngx_module_name=ngx_http_upstream_ntlm_module
    ngx_module_srcs="$ngx_addon_dir/ngx_http_upstream_ntlm_module.c \
                     $ngx_addon_dir/src/ntlm_abort.c"
    ngx_module_deps="$ngx_addon_dir/src/ntlm_abort.h"
    . auto/module
else
    # Сборка как add-on (обычный путь --add-dynamic-module=...)
    HTTP_MODULES="$HTTP_MODULES ngx_http_upstream_ntlm_module"
    NGX_ADDON_SRCS="$NGX_ADDON_SRCS \
        $ngx_addon_dir/ngx_http_upstream_ntlm_module.c \
        $ngx_addon_dir/src/ntlm_abort.c"
    NGX_ADDON_DEPS="$NGX_ADDON_DEPS \
        $ngx_addon_dir/src/ntlm_abort.h"
fi